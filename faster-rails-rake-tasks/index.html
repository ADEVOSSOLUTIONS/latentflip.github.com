<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Faster rake tasks in Rails</title>
    <link rel='stylesheet' href='/assets/stylesheets/app.css'>

    <script src='/assets/javascripts/jquery.js'></script>
    <script src='/assets/javascripts/underscore-min.js'></script>
    <script src='/assets/javascripts/angular.js'></script>
    <script src='/assets/javascripts/app.js'></script>
  </head>
  <body>
    <main ng-app='blog'>
      <div ng-controller='PostCtrl'>
  <div class="post post-text">
  <h1>Faster rake tasks in Rails</h1>
  <p>Rake tasks are awesome for project specific scripts among other things, but in rails projects they suck for short tasks that don&#39;t depend on rails. Here&#39;s why:</p>

<ol>
<li>You type <code>rake my_task_that_doesnt_depend_on_the_rails_environment</code></li>
<li>Rails loads (10-20 seconds)</li>
<li>Only then does your superfast rake task run. Boring!</li>
</ol>

<p>Looking for a solution I came across Xavier Shay&#39;s <a href="http://rhnh.net/2010/09/07/speeding-up-rails-rake">attempt</a> to deal with this. </p>

<p>His solution is to maintain a list of rails tasks which depend on Rails (like <code>rake db:migrate</code>) in your Rakefile, and have the Rails environment autoload when any of those tasks are called. Any tasks in lib/tasks will now run nice and fast.</p>

<p>This helped, but it means you have to maintain a list of all the Rails tasks you may want to use (and any rake tasks included by gems used in your app) in your Gemfile, or remember to append <code>LOAD_RAILS=1</code> to your rake call to force rails to load.</p>

<p>Because I can&#39;t be bothered trying to remember which of my tasks depend on rails, I modified his Rakefile to autoload the Rails environment if Rake can&#39;t find a task (on the assumption that it&#39;ll be hidden in Rails/gem somewhere. This has the side-benefit of loading the <code>:environment</code> task, that any tasks which require the Rails environment depend on, if and when needed.</p>

<p>If you have any thoughts I&#39;d love to hear them, the <a href="https://gist.github.com/1584072">gist is here</a>.</p>

<script src="https://gist.github.com/1584072.js?file=Rakefile"></script>

</div>


</div>

<nav>
  <a href="a-wee-whisky-cocktail">←</a>
  <a href="/">⚑</a>
  <a href="departing-the-north-sea-on-new-years-day-2012">→</a>
</nav>

    </main>
  </body>
</html>
